name: New WordPress.org release

on:
  release:
    types: [published]

jobs:
  tag:
    name: New release
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@master
      - name: WordPress Plugin Deploy
        id: wordpress_plugin_deploy
        uses: Pierre-Lannoy/wordpress-actions/dotorg-plugin-deploy@master
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          SLUG: keys-master
          NAME: Keys Master
          SVN_PASSWORD: ${{ secrets.SVN_PASSWORD }}
          SVN_USERNAME: ${{ secrets.SVN_USERNAME }}
      - name: Artifact Upload
        id: artifact_upload
        uses: actions/upload-artifact@v4
        with:
          path: ${{ steps.wordpress_plugin_deploy.outputs.zip_path }}
      - name: Output artifact url
        run: echo 'Artifact url is ${{ steps.artifact-artifact_upload-step.outputs.artifact-url }}'